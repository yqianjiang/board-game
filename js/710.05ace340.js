"use strict";(self["webpackChunkboard_games"]=self["webpackChunkboard_games"]||[]).push([[710],{7710:function(e,t,r){r.r(t),r.d(t,{default:function(){return X}});var i=r(3396),c=r(7139),o=r(9242);const a=e=>((0,i.dD)("data-v-da87b8de"),e=e(),(0,i.Cn)(),e),n={class:"game-wrap"},l=a((()=>(0,i._)("h1",null,"俄罗斯方块",-1))),s=a((()=>(0,i._)("p",null,"请通过方向键控制下落的方块（方向键“上”可以顺时针旋转方块），使它们在底部排列成完整的水平行，一旦一行被填满，就会消失并腾出空间。目标是尽可能堆叠方块，避免屏幕顶部被方块堆满。",-1))),d={class:"stack toolbar"},p=(0,i.Uk)("游戏速度："),g=["disabled"],u={class:"game-main"},m={class:"grid"},v={class:"next-piece"},h=a((()=>(0,i._)("p",null,"Next piece: ",-1)));function w(e,t,r,a,w,f){return(0,i.wg)(),(0,i.iD)("div",n,[l,s,(0,i._)("div",d,[(0,i._)("span",null,"当前分数："+(0,c.zw)(e.score),1),(0,i._)("span",null,"最高得分："+(0,c.zw)(e.highScore),1),(0,i._)("div",null,[p,(0,i.wy)((0,i._)("input",{disabled:"over"!==e.gameState,"onUpdate:modelValue":t[0]||(t[0]=t=>e.speed=t),type:"number"},null,8,g),[[o.nr,e.speed]])]),"over"===e.gameState?((0,i.wg)(),(0,i.iD)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>a.startGame&&a.startGame(...e))}," 开始 ")):(0,i.kq)("",!0),"running"===e.gameState?((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:t[2]||(t[2]=(...e)=>a.pausedGame&&a.pausedGame(...e))}," 暂停 ")):"paused"===e.gameState?((0,i.wg)(),(0,i.iD)("button",{key:2,onClick:t[3]||(t[3]=(...e)=>a.resumeGame&&a.resumeGame(...e))}," 继续 ")):(0,i.kq)("",!0),"over"!==e.gameState?((0,i.wg)(),(0,i.iD)("button",{key:3,onClick:t[4]||(t[4]=(...e)=>a.restartGame&&a.restartGame(...e))}," 重新开始 ")):(0,i.kq)("",!0)]),(0,i._)("div",u,[(0,i._)("div",m,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.combinedGrid,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"row"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:(0,c.C_)(["cell",{"color-1":"active"===e}])},null,2)))),128))])))),128))]),(0,i._)("div",v,[h,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.nextPiece,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e[0],class:"row"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e,class:(0,c.C_)(["cell",{"color-1":e}])},null,2)))),128))])))),128))])])])}var f=r(4870);function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const b=[[[1,1],[1,1]],[[0,1,0],[1,1,1]],[[1,0],[1,0],[1,1]],[[0,1],[0,1],[1,1]],[[1,1,1],[0,1,0]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]],[[1],[1],[1],[1]]];class G{constructor(e,t){k(this,"grid",void 0),this.grid=this.createGrid(e,t)}createGrid(e,t){const r=[];for(let i=0;i<e;i++){r[i]=[];for(let e=0;e<t;e++)r[i][e]=""}return r}createPiece(){const e=Math.floor(Math.random()*b.length);return b[e]}canMoveTo(e,t,r,i){for(let c=0;c<t.length;c++)for(let o=0;o<t[c].length;o++)if(1===t[c][o]){const t=r+o,a=i+c;if(t<0||t>=e[0].length||a>=e.length)return console.log("can't move because outside the grid"),!1;if(a>=0&&""!==e[a][t])return console.log("can't move because occupied:",a,t),!1}return!0}removeFromGrid(e,t,r,i){for(let c=0;c<t.length;c++)for(let o=0;o<t[c].length;o++)1===t[c][o]&&(e[i+c][r+o]="")}addToGrid(e,t,r,i){for(let c=0;c<t.length;c++)for(let o=0;o<t[c].length;o++)1===t[c][o]&&(e[i+c][r+o]="active")}moveTo(e,t,r,i,c){e.pieceX=i,e.pieceY=c}rotate(e){const t=[];for(let r=0;r<e[0].length;r++){t[r]=[];for(let i=e.length-1;i>=0;i--)t[r].push(e[i][r])}return t}removeRows(e){let t=0;for(let r=0;r<e.length;r++)e[r].every((e=>""!==e))&&(e.splice(r,1),t+=10,e.unshift(new Array(10).fill("")));return t}}const[Y,y]=[20,10],D=new G(Y,y);var _={name:"Tetris",setup(){const e=(0,f.qj)({grid:D.createGrid(Y,y),piece:D.createPiece(),pieceX:y/2-2,pieceY:0,nextPiece:D.createPiece(),score:0,gameState:"over",speed:3,highScore:0});let t=null;const r=(0,f.BK)(e),c=(0,i.Fl)((()=>{const t=e.grid.map((e=>[...e]));if("over"===e.gameState)return t;for(let r=0;r<e.piece.length;r++)for(let i=0;i<e.piece[r].length;i++)1===e.piece[r][i]&&(t[e.pieceY+r][e.pieceX+i]="active");return t})),o=()=>{e.gameState="running",e.piece=e.nextPiece,e.nextPiece=D.createPiece(),t=setInterval(s,Math.floor(2e3/e.speed)),document.addEventListener("keydown",p)},a=()=>{e.gameState="paused",clearInterval(t),document.removeEventListener("keydown",p)},n=()=>{e.gameState="running",t=setInterval(s,Math.floor(2e3/e.speed)),document.addEventListener("keydown",p)},l=()=>{e.gameState="over",e.score>e.highScore&&(e.highScore=e.score),e.grid=D.createGrid(Y,y),e.piece=D.createPiece(),e.pieceX=0,e.pieceY=0,e.nextPiece=D.createPiece(),e.score=0,clearInterval(t),document.removeEventListener("keydown",p)},s=()=>{"running"===e.gameState&&(D.canMoveTo(e.grid,e.piece,e.pieceX,e.pieceY+1)?D.moveTo(e,e.grid,e.piece,e.pieceX,e.pieceY+1):e.pieceY<=0?(alert("游戏结束！"),l()):(D.addToGrid(e.grid,e.piece,e.pieceX,e.pieceY),e.score+=D.removeRows(e.grid),e.piece=e.nextPiece,e.pieceX=y/2-2,e.pieceY=0,e.nextPiece=D.createPiece()))},d={moveLeft:()=>{D.canMoveTo(e.grid,e.piece,e.pieceX-1,e.pieceY)&&D.moveTo(e,e.grid,e.piece,e.pieceX-1,e.pieceY)},moveRight:()=>{D.canMoveTo(e.grid,e.piece,e.pieceX+1,e.pieceY)&&D.moveTo(e,e.grid,e.piece,e.pieceX+1,e.pieceY)},moveDown:()=>{D.canMoveTo(e.grid,e.piece,e.pieceX,e.pieceY+1)&&D.moveTo(e,e.grid,e.piece,e.pieceX,e.pieceY+1)},rotate:()=>{e.piece=D.rotate(e.piece),D.canMoveTo(e.grid,e.piece,e.pieceX,e.pieceY)||(e.piece=D.rotate(e.piece),e.piece=D.rotate(e.piece),e.piece=D.rotate(e.piece))}},p=e=>{switch(e.key){case"ArrowLeft":d.moveLeft();break;case"ArrowRight":d.moveRight();break;case"ArrowDown":d.moveDown();break;case"ArrowUp":d.rotate();break}};return{...r,combinedGrid:c,startGame:o,pausedGame:a,resumeGame:n,restartGame:l}}},S=r(89);const P=(0,S.Z)(_,[["render",w],["__scopeId","data-v-da87b8de"]]);var X=P}}]);
//# sourceMappingURL=710.05ace340.js.map